---
import Text from "./Text.astro";
import IconLight from "./icons/IconLight.astro";
import IconDark from "./icons/IconDark.astro";
---

<theme-switcher>
  <Text
    tag="span"
    class="navbar-theme-switcher navbar-theme-switcher-hidden navbar-theme-light"
  >
    <IconLight />
  </Text>
  <Text tag="span" class="navbar-theme-switcher navbar-theme-dark">
    <IconDark />
  </Text>
</theme-switcher>

<script>
  class ThemeSwitcher extends HTMLElement {
    constructor() {
      super();

      const bodyEl = document.body;
      const iconLightEl = this.querySelector(".navbar-theme-light");
      const iconDarkEl = this.querySelector(".navbar-theme-dark");

      const bodyDarkClass = "dark";
      const iconHiddenClass = "navbar-theme-switcher-hidden";

      iconDarkEl.addEventListener("click", () => {
        const checkBodyElDark = bodyEl.classList.contains(bodyDarkClass);
        if (!checkBodyElDark) {
          bodyEl.classList.add(bodyDarkClass);
          iconLightEl.classList.remove(iconHiddenClass);
          iconDarkEl.classList.add(iconHiddenClass);
        }
      });

      iconLightEl.addEventListener("click", () => {
        const checkBodyElDark = bodyEl.classList.contains(bodyDarkClass);
        if (checkBodyElDark) {
          bodyEl.classList.remove(bodyDarkClass);
          iconLightEl.classList.add(iconHiddenClass);
          iconDarkEl.classList.remove(iconHiddenClass);
        }
      });
    }
  }

  customElements.define("theme-switcher", ThemeSwitcher);
</script>
